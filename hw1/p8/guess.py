# coding: utf-8
from pwn import *
import hashlib

p = 262603487816194488181258352326988232210376591996146252542919605878805005469693782312718749915099841408908446760404481236646436295067318626356598442952156854984209550714670817589388406059285064542905718710475775121565983586780136825600264380868770029680925618588391997934473191054590812256197806034618157751903
"""
for iter1 in range(1,21):
    for iter2 in range(1,21):
        for iter3 in range(1,21):
"""          
            
def guess(b0,b1,b2,cipher):   
    num_to_send = [1,1,1]
    num_to_send = [int(hashlib.sha512(str(i)).hexdigest(),16) for i in num_to_send]
    g = [pow(i,2,p) for i in num_to_send]
    b = [b0,b1,b2]
    
    for keys in b:
        cipher ^= int(hashlib.sha512(str(keys)).hexdigest(), 16)
    print (cipher)
    flag = "{0:x}".format(cipher)
    print (flag)
    if len(flag)%2==0:
        flag = flag.decode("hex")
        if "BALSN" in flag:
            print flag
            exit()
        print flag


b0 = 151561684488003599280755873930466875188441065765511210028437669968820370371289922634911422607703901219609221784865053119596564195766538958117619898697500018410438655433734824525202283194143994704870919367178161659747496937426664197005926785096944716582925796170274961320211635774558616951525661207923249820208
b1 = 32687392374941728115384861035882359767272309895101585497108272582870044594227508843651297838233245735102788626928134562891472772690686711974446297778063893927170635830749668312866644510225721945940727431002235946926149007293297613973532327536992986646641368034041663464324967456463353321350208042765586221019
b2 = 18654424226194267899495773783474493005552391159866159221359641684863625667338416030200991423003426950650305142006050618474896541514083590839434610739339784881525400862153952311912220210548117981221067127833610165242341246300160022246523719647792946728530841086137825119569330086495672829337655890542021105413


cipher =2601140430028947989724008612913301902169830749268744031937027255480381502648891257001900257398048554313654109365565906121029403181345045130618547780838510


guess(b0,b1,b2,cipher)
